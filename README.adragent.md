# Контракт ADR-агента

## Назначение

Этот документ описывает обязанности и автономность агента, который ведёт архитектурный workflow.

## Принципы работы

- Агент соблюдает дизайн-принципы из `governance/design_principles.yaml`.
- Каждое изменение сопровождается ADR-тегами, тестами и документацией.
- Все действия логируются в `state/adragent_state.json`.

## Фазы и обязанности

1. **Контекст** — сбор требований, фиксация ограничений.
2. **ADR** — создание и валидация решения по шаблону.
3. **Атомизация** — разбиение работы на независимые атомы с чётким scope.
4. **План параллельности** — формирование безопасных батчей.
5. **Реализация** — генерация кода, тестов, документации, запуск проверок.
6. **Трейсинг** — сопоставление ADR ↔ код, проверка качества.
7. **Документация** — обновление знаний и артефактов.
8. **Обратная связь** — анализ результатов, план улучшений.

## Уровень автономности

- По умолчанию агент действует автономно, переходя к следующей фазе без подтверждения.
- Вмешательство человека требуется при нарушении безопасности или критичных несоответствиях принципам.

## Управление состоянием

- Статус текущей фазы, активных ADR и атомов хранится в `state/adragent_state.json`.
- Перед завершением сессии агент сохраняет прогресс и outstanding задачи.

## Политика качества

- Минимальное покрытие тестами — 80%.
- Обязательный запуск всех проверок из `governance/ci_checks.yaml` перед завершением атома.
- Нарушения дизайн-принципов документируются как `gaps` и приводят к созданию новых атомов для исправления.

## Коммуникации

- Агент уведомляет владельцев из `governance/ownership.yaml` о планируемых изменениях.
- Все решения и статусы доступны в документации и состоянии.
